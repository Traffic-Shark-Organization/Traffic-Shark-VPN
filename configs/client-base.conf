# OpenVPN Client Configuration
# Базовая конфигурация для подключения к Traffic Shark VPN

##############################################
# Режим клиента
##############################################

client

##############################################
# Сетевые параметры
##############################################

# Использовать TUN устройство (routed VPN)
dev tun

# Протокол и адрес сервера
# ЗАМЕНИТЕ на реальный IP или домен вашего VPS
proto udp
remote YOUR_SERVER_IP 1194

# Продолжать попытки подключения бесконечно
resolv-retry infinite

# Не привязываться к локальному порту
nobind

# Topology должна совпадать с сервером
topology subnet

##############################################
# Безопасность и привилегии
##############################################

# Понижение привилегий после установки соединения
# Windows не поддерживает эти директивы - они будут проигнорированы
user nobody
group nogroup

# Сохранять состояние при понижении привилегий
persist-key
persist-tun

##############################################
# Шифрование и аутентификация
##############################################

# Минимальная версия TLS
tls-version-min 1.3

# TLS cipher suites
tls-cipher TLS-ECDHE-RSA-WITH-AES-256-GCM-SHA384:TLS-ECDHE-ECDSA-WITH-AES-256-GCM-SHA384

# Data channel cipher (должен совпадать с сервером)
cipher AES-256-GCM

# HMAC authentication
auth SHA512

# Проверка сертификата сервера
remote-cert-tls server

# Направление TLS-auth (клиент использует 1)
key-direction 1

##############################################
# Производительность
##############################################

# Размеры буферов (оптимизация для производительности)
sndbuf 393216
rcvbuf 393216

# Отключение compression (безопасность)
compress migrate

##############################################
# Логирование
##############################################

# Уровень детализации логов
# 0 - только критичные ошибки
# 3 - стандартная информация (рекомендуется)
# 5-9 - отладка
verb 3

# Ограничение повторяющихся сообщений
mute 20

##############################################
# Keepalive и таймауты
##############################################

# Проверка соединения (должно совпадать с сервером)
# ping каждые 10 секунд, restart при таймауте 120 секунд
# Эти параметры обычно push'ятся сервером

##############################################
# Дополнительные параметры
##############################################

# Notification при явном выходе
explicit-exit-notify 3

# Игнорировать неизвестные опции от сервера
# Полезно для совместимости разных версий OpenVPN
# pull-filter ignore "ifconfig-ipv6"
# pull-filter ignore "route-ipv6"

##############################################
# Сертификаты и ключи
##############################################

# Сертификаты будут добавлены скриптом генерации конфигурации
# В inline формате между тегами:
# <ca>...</ca>
# <cert>...</cert>
# <key>...</key>
# <tls-auth>...</tls-auth>

# Альтернатива - внешние файлы (менее удобно):
# ca ca.crt
# cert client.crt
# key client.key
# tls-auth ta.key 1

##############################################
# Платформо-специфичные настройки
##############################################

# Windows: использовать Interactive Service для повышения привилегий
# Необходимо для изменения маршрутов и DNS
# Раскомментируйте для Windows клиентов:
# block-outside-dns
# register-dns

# macOS: использовать системный resolver
# script-security 2
# up /etc/openvpn/update-resolv-conf
# down /etc/openvpn/update-resolv-conf

##############################################
# Дополнительная безопасность
##############################################

# Проверка hostname сервера (опционально)
# Требует настройки verify-x509-name на сервере
# verify-x509-name server_1 name

# Отключение renegotiation
reneg-sec 0

##############################################
# Обработка ошибок
##############################################

# Стратегия переподключения
# connect-retry 5     # Пауза между попытками (секунды)
# connect-retry-max 3 # Максимум попыток (0 = бесконечно)

##############################################
# Примечания
##############################################

# 1. Замените YOUR_SERVER_IP на реальный IP вашего VPS
#
# 2. Для использования TCP (если UDP блокируется):
#    proto tcp
#    remote YOUR_SERVER_IP 443
#
# 3. Для подключения:
#    Linux/Mac: sudo openvpn --config client.ovpn
#    Windows: Импортируйте .ovpn в OpenVPN GUI
#
# 4. Проверка статуса соединения:
#    Linux: ip addr show tun0
#    Windows: ipconfig
#
# 5. Тестирование VPN:
#    curl ifconfig.me  # Должен показать IP VPN сервера
#
# 6. DNS leak тест:
#    https://www.dnsleaktest.com/
#
# 7. Troubleshooting:
#    - Увеличьте verb до 5-9 для детальных логов
#    - Проверьте firewall на клиенте
#    - Убедитесь, что сервер доступен: ping YOUR_SERVER_IP
#    - Проверьте, что порт открыт: nc -zvu YOUR_SERVER_IP 1194

